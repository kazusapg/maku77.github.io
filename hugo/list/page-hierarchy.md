---
title: "サイト内の全ページの一覧をセクションの階層構造に従って表示する"
date: "2018-01-09"
---

下記のテンプレートコードを使用すると、サイト内の全てのセクションと、ページをツリー構造で表示することができます。
すべてのページのリンクが出力されるので、サイトマップの出力に使用したり、ホームページ用のテンプレートに利用するとよいでしょう。

ここでは、ホームページ用のテンプレート（`layouts/index.html`) に適用してみます。

#### layouts/index.html（抜粋）

~~~
<h2>全ページのリスト</h2>

{{ "{{" }}- define "hierarchy" }}
  <ul>
    <li><a href="{{ "{{" }} .Permalink }}">{{ "{{" }} .Title }}</a>
      {{ "{{" }}/* カレントセクション直下のセクションは再帰処理 */}}
      {{ "{{" }}- range .Sections }}
        {{ "{{" }}- template "hierarchy" . }}
      {{ "{{" }}- end }}

      {{ "{{" }}/* カレントセクション直下のページリスト（ホームだけ特殊処理） */}}
      <ul>
        {{ "{{" }}- range (cond .IsHome (where $.Site.RegularPages "Section" "") .Pages) }}
          <li><a href="{{ "{{" }} .Permalink }}">{{ "{{" }} .Title }}</a>
        {{ "{{" }}- end }}
      </ul>
    </li>
  </ul>
{{ "{{" }}- end }}

{{ "{{" }} template "hierarchy" .Site.Home }}
~~~

上記のコードでは、部分テンプレート `hierarchy` を定義し、これをホームページ (`.Site.Home`) から再帰的に呼び出すことで全ページのツリー構造を出力しています。
ここでは、`.Site.Home` をルートに設定して呼び出しているため、サイト全体のページツリーが出力されますが、任意のセクションをルートにしてページツリーを出力することもできます。

#### 出力結果のイメージ（実際には各項目がリンクになります）

~~~~
* ホーム
    * セクション 1
        * セクション 1-1
            * タイトル 1-1-A
            * タイトル 1-1-B
        * セクション 1-2
            * タイトル 1-2-A
            * タイトル 1-2-B
        * タイトル 1-A
        * タイトル 1-B
    * セクション 2
        * セクション 2-1
            * タイトル 2-1-A
            * タイトル 2-1-B
        * セクション 2-2
            * タイトル 2-2-A
            * タイトル 2-2-B
        * タイトル 2-A
        * タイトル 2-B
    * タイトル A
    * タイトル B
~~~

