---
title: "シェルスクリプト: 任意のコマンドの実行結果を一行ずつ処理する"
date: "2017-11-01"
---

例えば、`ls -aFl` といった外部コマンドの出力結果を一行ずつ処理するには、下記のようにパイプで `while read` に繋ぎます。
`line` というのは変数名なので別の名前に変えても大丈夫です。

~~~ bash
ls -aFl | while read line; do
  echo "$line"
done
~~~

<div class="note">
<code>$line</code> をダブルクォーテーションで囲んでいるのは、<code>echo</code> が行中の連続したスペースを 1 つのスペースにまとめて出力してしまうのを防ぐためです。
</div>

### おまけ: IFS 変数を使った方法

`while read` を使う方法ではなく、`IFS` 変数の値を変更することで、コマンドの出力結果を 1 行ずつ処理する方法もあります。

~~~ bash
IFS='
'

for i in $( ls -aFl ); do
  echo $i
done

unset IFS
~~~

`for` ループの `in` の後ろに渡した文字列は、デフォルトでは各要素がスペースで区切られているとみなされます。
`IFS` 変数の値を上記のように改行だけ含むように変更すると、`for` ループの各要素が改行で区切られるようになります。
`IFS` 変数を `unset` すると、元に戻ってスペースで区切られるようになります。

